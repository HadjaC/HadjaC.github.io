<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compras - Livraria Minela</title>
    <link rel="stylesheet" href="../CSS/minela.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <div class="contprinc">
        <header style="background-image: url('../IMAGEM/banner.jpg'); background-repeat: no-repeat;background-size: 100%;height: 700px;">
            <nav>
                <ul class="listnav">
                    <li ><a href="../index.html">Home</a></li>
                    <li ><a href="./Categorias.html">Categorias</a></li>
                    <li ><a href="./sobre.html">Sobre</a></li>
                    <li ><a href="./compras.html">Compras</a></li>
                    <li ><a href="./Contacto.html">Contacto</a></li>
                    <li ><a href="./login.html"><button>Login</button></a></li>
                </ul>
            </nav>
        </header>
        <section class="corpo">
            <section class="livros">
                <h1>Produtos Disponíveis</h1>
                <div class="master" style="display: flex;justify-content: center;">
                    <div class="livro">
                        <img src="../IMAGEM/f1.jpg" alt="">
                        <p>Titulo:Duna</p>
                        <p>Preço: $20</p>
                        <p>Lançamento: 10/10/2024</p>
                        <p></p>
                        <button  class="fa-solid fa-cart-shopping" onclick="adicionarAoCarrinho('Duna', 20)"></button></button>
                    </div>
                    <div class="livro">
                        <img src="../IMAGEM/f2.jpg" alt="">
                        <p>Titulo:Star Wars</p>
                        <p>Preço: Grátis</p>
                        <p>Lançamento: 10/10/2024</p>
                        <p></p>
                        <button  class="fa-solid fa-cart-shopping" onclick="adicionarAoCarrinho('Star Wars', 0)"></button>
                    </div>
                    <div class="livro">
                        <img src="../IMAGEM/f3.jpg" alt="">
                        <p>Titulo:Harry Potter e a pedra filosofal</p>
                        <p>Preço: $25</p>
                        <p>Lançamento: 10/10/2024</p>
                        <p></p>
                        <button  class="fa-solid fa-cart-shopping" onclick="adicionarAoCarrinho('Harry Potter', 25)"></button>
                    </div>
                    <div class="livro">
                        <img src="../IMAGEM/r3.jpg" alt="">
                        <p>Titulo:Orgulho e preconceito</p>
                        <p>Preço: Grátis</p>
                        <p>Lançamento: 10/10/2024</p>
                        <p></p>
                        <button  class="fa-solid fa-cart-shopping" onclick="adicionarAoCarrinho('Orgulho e preconceito', 0)"></button>
                    </div>
                    <div class="livro">
                        <img src="../IMAGEM/a5.jpg" alt="">
                        <p>Titulo:Os 4 ases e o tirano</p>
                        <p>Preço: $10</p>
                        <p>Lançamento: 10/10/2024</p>
                        <p></p>
                        <button  class="fa-solid fa-cart-shopping" onclick="adicionarAoCarrinho('Os 4 ases', 10)"></button>
                    </div>
                    <div class="livro">
                        <img src="../IMAGEM/a1.jpg" alt="">
                        <p>Titulo:Alice no país das maravilhas</p>
                        <p>Preço: Grátis</p>
                        <p>Lançamento: 10/10/2024</p>
                        <p></p>
                        <button  class="fa-solid fa-cart-shopping" onclick="adicionarAoCarrinho('Alice no país das maravilhas', 0)"></button>
                    </div>
                    <div class="livro">
                        <img src="../IMAGEM/aj7.jpg" alt="">
                        <p>Titulo:A sabedoria do eneagrama</p>
                        <p>Preço: $25</p>
                        <p>Lançamento: 10/10/2024</p>
                        <p></p>
                        <button  class="fa-solid fa-cart-shopping" onclick="adicionarAoCarrinho('A sabedoria do eneagrama', 25)"></button>
                    </div>
                    <div class="livro">
                        <img src="../IMAGEM/aj6.jpg" alt="">
                        <p>Titulo:Por que fazemos o que fazemos</p>
                        <p>Preço: $15</p>
                        <p>Lançamento: 10/10/2024</p>
                        <p></p>
                        <button  class="fa-solid fa-cart-shopping" onclick="adicionarAoCarrinho('Porque fazemos o que fazemos', 15)"></button>
                    </div>
                    <div class="livro">
                        <img src="../IMAGEM/a2.jpg" alt="">
                        <p>Titulo:Alice do outro lado do espelho</p>
                        <p>Preço: Grátis</p>
                        <p>Lançamento: 10/10/2024</p>
                        <p></p>
                        <button  class="fa-solid fa-cart-shopping" onclick="adicionarAoCarrinho('lice do outro lado do espelho', 0)"></button>
                    </div>
                </div>
            </section>
        </section>
        <footer>
            <!-- Footer -->
        </footer>
    </div>

    <div id="carrinho-info" style="position: fixed; bottom: 0; left: 0; width: 100%; background-color: #f0f0f0; padding: 10px; text-align: center; display: none;">
        <div id="carrinho-itens">
            <!-- Aqui serão adicionados dinamicamente os itens do carrinho -->
        </div>
        <span id="total-pagar"></span>
        <button id="finalizarCompraBtn">Finalizar Compra</button>
    </div>

    <div id="avisoCompraFinalizada" class="aviso-compra">
        <p>Compra finalizada com sucesso!</p>
    </div>
    

    <script>
        let carrinho = []; // Array para armazenar os itens do carrinho

        function adicionarAoCarrinho(titulo, preco) {
            // Verificar se o livro já está no carrinho
            let itemExistente = carrinho.find(item => item.titulo === titulo);

            if (preco === 0) {
                alert("Este livro é grátis e não pode ser adicionado ao carrinho.");
                return;
            }

            if (itemExistente) {
                // Se o livro já existe, incrementar a quantidade selecionada
                itemExistente.quantidadeSelecionada++;
            } else {
                // Se o livro não existe, adicioná-lo ao carrinho com quantidade 1
                carrinho.push({ titulo, preco, quantidade: 1, quantidadeSelecionada: 1 });
            }

            // Atualizar a exibição do carrinho
            atualizarCarrinho();
        }

        function removerDoCarrinho(index) {
            // Reduzir a quantidade selecionada
            if (carrinho[index].quantidadeSelecionada > 1) {
                carrinho[index].quantidadeSelecionada--;
            } else {
                // Se a quantidade selecionada for 1, remover o item do carrinho completamente
                carrinho.splice(index, 1);
            }

            atualizarCarrinho();
        }

        function atualizarCarrinho() {
            // Limpar conteúdo atual do carrinho
            const carrinhoItens = document.getElementById('carrinho-itens');
            carrinhoItens.innerHTML = '';

            // Atualizar a lista de itens do carrinho
            carrinho.forEach((item, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.classList.add('item-carrinho');

                const itemHTML = `
                    <span>${item.titulo} ${item.quantidadeSelecionada > 1 ? `(${item.quantidadeSelecionada}x)` : ''} - $${(item.preco * item.quantidade).toFixed(2)}</span>
                    <button onclick="removerDoCarrinho(${index})">Remover</button>
                `;
                itemDiv.innerHTML = itemHTML;

                carrinhoItens.appendChild(itemDiv);
            });

            // Atualizar total a pagar
            const totalPagar = calcularTotal();
            document.getElementById('total-pagar').innerText = `Total a Pagar: $${totalPagar.toFixed(2)}`;

            // Exibir carrinho
            document.getElementById('carrinho-info').style.display = 'block';
        }

        function calcularTotal() {
            return carrinho.reduce((total, item) => total + (item.preco * item.quantidadeSelecionada), 0);
        }

        // Simulação inicial de adição de itens ao carrinho
        document.addEventListener('DOMContentLoaded', function() {
        });

        let usuarioLogado = true; // Exemplo: variável que indica se o usuário está logado

        function verificarLogin() {
            // Simulação simples de verificação de login
            if (!usuarioLogado) {
                alert("Você precisa estar logado para finalizar a compra.");
                // Redirecionar para a página de login
                window.location.href = './login.html';  // Substitua pelo caminho correto da página de login
                return false; // Indica que o usuário não está logado
            }
            return true; 
        }

        document.addEventListener('DOMContentLoaded', function() {
        // Event listener para o botão "Finalizar Compra"
        document.getElementById('finalizarCompraBtn').addEventListener('click', function() {
            // Verificar se o usuário está logado
            if (verificarLogin()) {
                // Exibir aviso de compra finalizada
                document.getElementById('avisoCompraFinalizada').style.display = 'block';

                // Limpar o carrinho (função fictícia para limpar o carrinho)
                limparCarrinho();

                // Redirecionar para a página inicial após alguns segundos (simulação)
                setTimeout(function() {
                    window.location.href = '../index.html';  // Substitua pelo caminho correto da página inicial
                }, 2000); 
            }
        });
    });

    function limparCarrinho() {
    carrinho = []; 
    atualizarCarrinho();  
  }


    </script>
</body>
</html>
